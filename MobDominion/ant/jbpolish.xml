<!-- This file controls the build process.                    -->
<!-- The most important target is the j2mepolish-target,      -->
<!-- which controls for what devices the application should   -->
<!-- be created and so on.                                    -->
<!--                                                          -->
<!-- Important: when you have no Wireless Toolkit installed   -->
<!-- you need to define the "preverify"-attribute             -->
<!-- of the <build>-element of the J2ME Polish task.          -->
<!--                                                          -->
<!-- When you call Ant from the command-line, you can         -->
<!-- call "ant test j2mepolish" to skip the obfuscation       -->
<!-- and to build the example for fewer handsets.             -->
<!-- The default target builds and obfuscates the example.    -->
<!--                                                          -->
<!-- The full documentation can be found at                   -->
<!-- http://www.j2mepolish.org                                -->
<!--                                                          -->
<!-- Have fun!                                                -->
<project name="Mobile Dominion" default="j2mepolish" basedir="..">

	<!-- import global properties                                 -->
	<property file="${polish.home}/global.properties" />

	<!-- import user specific properties                          -->
	<property file="ant/project.properties" />




	<!-- the device for the test mode - you can define it on the command-line
	     using the -D switch, e.g. ant -Ddevice=Generic/midp2 emulator -->
	<property name="device" value="Generic/jtwi" />
	<property name="devices" value="${device},Nokia/Midp2Cldc11" />


	<!-- Definition of the J2ME Polish task:                      -->
	<taskdef name="j2mepolish" classname="de.enough.polish.ant.PolishTask" classpath="${polish.classpath}" />


	

	<target name="test" description="Call this target first to skip the obfuscation step and call the emulator, e.g. ant test j2mepolish">
		<property name="test" value="true" />
		<property name="dir.work" value="build/test" />
	</target>

	<target name="init">
		<property name="test" value="false" />
		<property name="dir.work" value="build/real" />
		<property name="deploy-url" value="" />
		<property name="resource.dir" value="resources" />
	</target>

	<!-- In this target the J2ME Polish task is used.             -->
	<!-- It has 3 sections:                                       -->
	<!--    1. The info-section defines some general information  -->
	<!--    2. The deviceRequirements-section chooses the devices -->
	<!--       for which the application is optimized.            -->
	<!--    3. The build-section controls the actual build        -->
	<!--       process.                                           -->
	<target name="j2mepolish" depends="init" description="This is the controller for the J2ME build process.">
		<j2mepolish>
			<!-- general settings, these settings basically form the JAD-attributes. -->
			<!-- Have a look at the <jad>-section for setting specialised attributes.
		         You can also define localized attributes in the resources/messages.txt files -->
			<info 
				name="MobileDominion" 
				version="0.1.12" 
				description="A Dominion Card randomizer" 
				vendorName="Nick A/S" 
				infoUrl="Not supported" 
				jarName="${ nospace(polish.vendor) }-${ nospace(polish.name) }-Dominion.jar" 
				jarUrl="${deploy-url}${polish.jarName}" 
				copyright="Copyright 2009 Nick A/S. All rights reserved."
				deleteConfirm="Do you really want to kill me?" 
			/>
			<!-- selection of supported devices -->
			<!-- In the test mode the application is build only for the  -->
			<!-- Generic/midp1 phone, but when the test-property is set to false, -->
			<!-- the second deviceRequirements will be used instead. -->
			<deviceRequirements if="test">
				<requirement name="Identifier" value="${devices}" />
			</deviceRequirements>
			<deviceRequirements unless="test">
				<requirement name="Identifier" value="${devices}" />
			</deviceRequirements>

			<!-- build settings -->
			<build symbols="ExampleSymbol, AnotherExample" fullscreen="menu" usePolishGui="true" workDir="${dir.work}">
				<!-- javacTarget="${javac.target}" -->
				<!-- preverify="${preverify.file}"
			midp2Path="${polish.home}/import/midp-2.0.jar"
				midlets definition -->
				<midlets>
					<midlet class="canvas.GameApp" name="Dominion Randomizer" icon="resources/img/main.png" number="1" />
				</midlets>

				<!-- project-wide variables - used for preprocessing.  -->
				<!-- You can set localized variables in the resources/messages.txt files as well.  -->
				<variables includeAntProperties="true">
					<!-- example variables:
					In your Java-code you can use the following snipet to use this variable:
					//#= private static final String UPDATE_URL = "${ update-url }";
					You can change the title of the sample application with the "title"-var.
					-->
					<variable name="polish.TextField.useDirectInput" value="true" />
					<variable name="polish.ScreenInfo.enable" value="true" />
				</variables>
				<resources dir="${resource.dir}" defaultexcludes="yes" excludes="readme.txt">
					<root dir="${resource.dir}" />
					<root dir="${resource.dir}/img" />
					<root dir="${resource.dir}/cards" />
					<!--root dir="${resource.dir}/lang"  />
					<localization locales="da_DK, en_GB" unless="test" />
					<localization locales="en_GB" if="test" /-->
				</resources>

				<!-- obfuscator settings: do not obfuscate when the test-property is true-->
				<obfuscator name="ProGuard" unless="test or polish.blackberry">
					<parameter name="optimize" value="true" />
					<parameter name="optimizationpasses" value="1" />
				</obfuscator>
				<!-- info memory -->
				<debug if="info" showLogOnError="true" verbose="true" level="info">
				</debug>
				<!-- user defined JAD attributes can also be used: -->
				<jad>
					<attribute name="Nokia-MIDlet-Category" value="Game" if="polish.group.Series40" />
				</jad>
			</build>

			<!-- execution of emulator(s) -->
			<emulator wait="true" securityDomain="trusted" enableProfiler="true" enableMemoryMonitor="true" enableNetworkMonitor="true" if="debug">
				<!-- this is an example for connecting to a debugger - use the ${polish.debug.port} Ant property
				     for getting to know the port of the debugger. In this example the 
				     "connect-debugger" target is also required.
				-->
				<!--
				<debugger name="antcall" target="connect-debugger" port="6001" />
				-->
			</emulator>

			<emulator wait="true" trace="none" securityDomain="trusted" enableProfiler="false" enableMemoryMonitor="false" enableNetworkMonitor="false" if="test and not debug">
			</emulator>
		</j2mepolish>
	</target>

	<!-- depends="test,j2mepolish"  -->
	<target name="emulator" description="invokes the emulator">
	</target>

	<target name="clean" description="allows a clean build. You should call [ant clean] whenever you made changes to devices.xml, vendors.xml or groups.xml">
		<delete dir="build" />
		<delete dir="dist" includes="**/*" />
	</target>

	<target name="cleanbuild" description="allows a clean build. You should call [ant cleanbuild] whenever you made changes to devices.xml, vendors.xml or groups.xml" depends="clean, j2mepolish" />

	<target name="debug" description="debugs the project" depends="enableDebug, test, enableInfo, j2mepolish" />

	<target name="infoAndMemory" description="debugs the project" depends="clean, enableInfo, enableMemory, j2mepolish" />
	
	<target name="Memory" description="debugs the project" depends="clean, enableMemory, j2mepolish" />

	<target name="enableDebug" description="Call this target first to skip the obfuscation step, call the emulator and start the debugger, e.g. ant enableDebug j2mepolish">
		<property name="debug" value="true" />
	</target>

	<target name="enableInfo" description="Call this target first to skip the obfuscation step, call the emulator and start the debugger, e.g. ant enableDebug j2mepolish">
		<property name="info" value="true" />
	</target>
	
	<target name="enableMemory" description="Call this target first to skip the obfuscation step, call the emulator and start the debugger, e.g. ant enableDebug j2mepolish">
		<property name="memory" value="true" />
	</target>
	<target name="deviceDebug" description="debugs the project" depends="enableDebug, enableInfo, j2mepolish" />
</project>
